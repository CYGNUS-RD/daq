<!DOCTYPE html>
<html class="mcss" lang="en">

<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="midas.css">
<script src="controls.js"></script>
<script src="midas.js"></script>
<script src="mhttpd.js"></script>
<script src="mhistory.js"></script>

<style>

.mydiv {
cursor: pointer;
color:#0000FF;
}
.mydiv:link { color:#0000FF; text-decoration:none }
.mydiv:visited { color:#800080; text-decoration:none }
.mydiv:hover { color:#0000FF; text-decoration:underline }
.mydiv:active { color:#0000FF; text-decoration:underline }
.mydiv:focus { color:#0000FF; text-decoration:none; }

input[type=number] {
   font-size: 100%;
}

input[type=number][disabled]{color:transparent; background-color:transparent; border-width: 0px;}

</style>

<script>

var d0_ring = 1.2;
var d_ring = 1.4;
var n_ring = 35;
var d_gem = 0.2;

window.onload = function() {

  mhttpd_init('HV');
  mhistory_init();

  var paths = ["/Equipment/HV/Variables/Demand[0-6]",
               "/Equipment/HV/Settings/Ramp Up Speed[0]",
               "/Equipment/HV/Settings/Ramp Down Speed[0]",
               "/Equipment/HV/Settings/Current Limit[0]",
               "/Equipment/HV/Settings/Trip Time[0]",
               "/Equipment/HV/Settings/Current Hot Spot[0]",
               "/Equipment/CATHODE/Variables/Demand[0]"
              ];

  mjsonrpc_db_get_values(paths).then(function(rpc) {

    document.getElementById('txtSetOffset').innerHTML = rpc.result.data[0][0];
    document.getElementById('txtSetG3').innerHTML = rpc.result.data[0][1];
    document.getElementById('txtSetG2').innerHTML = rpc.result.data[0][3];
    document.getElementById('txtSetG1').innerHTML = rpc.result.data[0][5];
    document.getElementById('txtSetT2').innerHTML = (rpc.result.data[0][2]/1000./d_gem).toFixed(3);
    document.getElementById('txtSetT1').innerHTML = (rpc.result.data[0][4]/1000./d_gem).toFixed(3);
    //document.getElementById('txtSetD').innerHTML = ((rpc.result.data[6] - (rpc.result.data[0][0] + rpc.result.data[0][1]+rpc.result.data[0][2]+rpc.result.data[0][3]+rpc.result.data[0][4]+rpc.result.data[0][5]+rpc.result.data[0][6]))/1000./(n_ring-1.)/d_ring).toFixed(3);
      document.getElementById('txtSetD').innerHTML = rpc.result.data[0][6]/1000./d0_ring;

    document.getElementById('txtRequestOffset').value = rpc.result.data[0][0];
    document.getElementById('txtRequestG3').value = rpc.result.data[0][1];
    document.getElementById('txtRequestG2').value = rpc.result.data[0][3];
    document.getElementById('txtRequestG1').value = rpc.result.data[0][5];
    document.getElementById('txtRequestT2').value = rpc.result.data[0][2]/1000./d_gem;
    document.getElementById('txtRequestT1').value = rpc.result.data[0][4]/1000./d_gem;
    //document.getElementById('txtRequestD').value = (rpc.result.data[6] - (rpc.result.data[0][0] + rpc.result.data[0][1]+rpc.result.data[0][2]+rpc.result.data[0][3]+rpc.result.data[0][4]+rpc.result.data[0][5]+rpc.result.data[0][6]))/1000./(n_ring*d_ring);
    document.getElementById('txtRequestD').value = rpc.result.data[0][6]/1000./d0_ring;


    var ch = 0;
    document.getElementById('rhv0').checked = true;
    document.getElementById('rup').value = rpc.result.data[1];
    document.getElementById('rdw').value = rpc.result.data[2];
    document.getElementById('trip').value = rpc.result.data[3];
    document.getElementById('tript').value = rpc.result.data[4];
    document.getElementById('hot').value = rpc.result.data[5];

  }).catch(function(error) {
       mjsonrpc_error_alert(error);
  });

}

function applySetAll() {

  txt = document.getElementById('txtRequestOffset');
  value = parseFloat(txt.value);
  document.getElementById('txtSetOffset').innerHTML = value;
  var setHV0 = value;

  if(document.getElementById('lockG3').checked){
   txt = document.getElementById('txtRequestG3');
  } 
  else{
   txt = document.getElementById('txtRequestG1');
  }
  var value = parseFloat(txt.value);
  document.getElementById('txtSetG3').innerHTML = value;
  var setHV1 = value;

  if(document.getElementById('lockT').checked){
    txt = document.getElementById('txtRequestT2');
  }
  else{
    txt = document.getElementById('txtRequestT1');
  }
  value = parseFloat(txt.value);
  document.getElementById('txtSetT2').innerHTML = value.toFixed(3);
  var setHV2 = value*1000.*d_gem;

  if(document.getElementById('lockG2').checked){
   txt = document.getElementById('txtRequestG2');
  } 
  else{
   txt = document.getElementById('txtRequestG1'); 
  }
  value = parseFloat(txt.value);
  document.getElementById('txtSetG2').innerHTML = value;
  var setHV3 = value;

  txt = document.getElementById('txtRequestT1');
  value = parseFloat(txt.value);
  document.getElementById('txtSetT1').innerHTML = value.toFixed(3);
  var setHV4 = value*1000.*d_gem;

  txt = document.getElementById('txtRequestG1');
  value = parseFloat(txt.value);
  document.getElementById('txtSetG1').innerHTML = value;
  var setHV5 = value;

  txt = document.getElementById('txtRequestD');
  value = parseFloat(txt.value);
  document.getElementById('txtSetD').innerHTML = value.toFixed(3);
  var setHV6 = value*1000*d0_ring;
  var setHV7 = setHV0 + setHV1 + setHV2 + setHV3 + setHV4 + setHV5 + setHV6 + value*1000*(n_ring-1)*d_ring;

  var paths = ["/Equipment/HV/Variables/Demand[0]",
               "/Equipment/HV/Variables/Demand[1]",
               "/Equipment/HV/Variables/Demand[2]",
               "/Equipment/HV/Variables/Demand[3]",
               "/Equipment/HV/Variables/Demand[4]",
               "/Equipment/HV/Variables/Demand[5]",
               "/Equipment/HV/Variables/Demand[6]",
               "/Equipment/CATHODE/Variables/Demand[0]"
              ];
  var sets = [setHV0,setHV1,setHV2,setHV3,setHV4,setHV5,setHV6,setHV7];

  mjsonrpc_db_paste(paths,sets).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applySetZero() {

  document.getElementById('txtSetD').innerHTML = 0;
  document.getElementById('txtSetT1').innerHTML = 0;
  document.getElementById('txtSetT2').innerHTML = 0;
  document.getElementById('txtSetG1').innerHTML = 0;
  document.getElementById('txtSetG2').innerHTML = 0;
  document.getElementById('txtSetG3').innerHTML = 0;
  document.getElementById('txtSetOffset').innerHTML = 0;

  var paths = ["/Equipment/HV/Variables/Demand[0-6]",
               "/Equipment/CATHODE/Variables/Demand[0]"
              ];

  mjsonrpc_db_paste(paths,[0,0]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function selectChannel(id){

  var paths = ["/Equipment/HV/Settings/Ramp Up Speed[0-6]",
               "/Equipment/HV/Settings/Ramp Down Speed[0-6]",
               "/Equipment/HV/Settings/Current Limit[0-6]",
               "/Equipment/HV/Settings/Trip Time[0-6]",
               "/Equipment/HV/Settings/Current Hot Spot[0-6]",
               "/Equipment/CATHODE/Settings/Ramp Up Speed[0]",
               "/Equipment/CATHODE/Settings/Ramp Down Speed[0]",
               "/Equipment/CATHODE/Settings/Current Limit[0]",
              ];

  mjsonrpc_db_get_values(paths).then(function(rpc) {
    if(id >= 0 && id < 7) { 
      document.getElementById('rup').value = rpc.result.data[0][id];
      document.getElementById('rdw').value = rpc.result.data[1][id];
      document.getElementById('trip').value = rpc.result.data[2][id];
      document.getElementById('tript').disabled = false;
      document.getElementById('hot').disabled = false;
      document.getElementById('tript').value = rpc.result.data[3][id];
      document.getElementById('hot').value = rpc.result.data[4][id];
    }
    else if(id == 7) { 
      document.getElementById('rup').value = rpc.result.data[5];
      document.getElementById('rdw').value = rpc.result.data[6];
      document.getElementById('trip').value = rpc.result.data[7];
      document.getElementById('tript').value = "";
      document.getElementById('hot').value = "";
      document.getElementById('tript').disabled = true;
      document.getElementById('hot').disabled = true;
    }
    else { 
      document.getElementById('rup').value = "";
      document.getElementById('rdw').value = "";
      document.getElementById('trip').value = "";
      document.getElementById('tript').value = "";
      document.getElementById('hot').value = "";
    }
  }).catch(function(error) {
       mjsonrpc_error_alert(error);
  });

}

function applyRUP(){

  var ch = "0-6";
  if(document.getElementById('rhv0').checked) ch="0";
  else if(document.getElementById('rhv1').checked) ch="1";
  else if(document.getElementById('rhv2').checked) ch="2";
  else if(document.getElementById('rhv3').checked) ch="3";
  else if(document.getElementById('rhv4').checked) ch="4";
  else if(document.getElementById('rhv5').checked) ch="5";
  else if(document.getElementById('rhv6').checked) ch="6";

  var paths;
  if(document.getElementById('rhv7').checked){
    paths = ["/Equipment/CATHODE/Settings/Ramp Up Speed[0]"];
  }
  else{
    paths = ["/Equipment/HV/Settings/Ramp Up Speed["+ch+"]"];
  }
  var sets = [parseFloat(document.getElementById('rup').value)];

  mjsonrpc_db_paste(paths,sets).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyRDW(){

  var ch = "0-6";
  if(document.getElementById('rhv0').checked) ch="0";
  else if(document.getElementById('rhv1').checked) ch="1";
  else if(document.getElementById('rhv2').checked) ch="2";
  else if(document.getElementById('rhv3').checked) ch="3";
  else if(document.getElementById('rhv4').checked) ch="4";
  else if(document.getElementById('rhv5').checked) ch="5";
  else if(document.getElementById('rhv6').checked) ch="6";

  var paths;
  if(document.getElementById('rhv7').checked){
    paths = ["/Equipment/CATHODE/Settings/Ramp Down Speed[0]"];
  }
  else{
    paths = ["/Equipment/HV/Settings/Ramp Down Speed["+ch+"]"];
  }

  var sets = [parseFloat(document.getElementById('rdw').value)];

  mjsonrpc_db_paste(paths,sets).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyTrip(){

  var ch = "0-6";
  if(document.getElementById('rhv0').checked) ch="0";
  else if(document.getElementById('rhv1').checked) ch="1";
  else if(document.getElementById('rhv2').checked) ch="2";
  else if(document.getElementById('rhv3').checked) ch="3";
  else if(document.getElementById('rhv4').checked) ch="4";
  else if(document.getElementById('rhv5').checked) ch="5";
  else if(document.getElementById('rhv6').checked) ch="6";

  var paths;
  if(document.getElementById('rhv7').checked){
    paths = ["/Equipment/CATHODE/Settings/Current Limit[0]"];
  }
  else{
    paths = ["/Equipment/HV/Settings/Current Limit["+ch+"]"];
  }

  var sets = [parseFloat(document.getElementById('trip').value)];

  mjsonrpc_db_paste(paths,sets).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyTripT(){

  var ch = "0-6";
  if(document.getElementById('rhv0').checked) ch="0";
  else if(document.getElementById('rhv1').checked) ch="1";
  else if(document.getElementById('rhv2').checked) ch="2";
  else if(document.getElementById('rhv3').checked) ch="3";
  else if(document.getElementById('rhv4').checked) ch="4";
  else if(document.getElementById('rhv5').checked) ch="5";
  else if(document.getElementById('rhv6').checked) ch="6";

  var paths = ["/Equipment/HV/Settings/Trip Time["+ch+"]"];

  var sets = [parseFloat(document.getElementById('tript').value)];

  mjsonrpc_db_paste(paths,sets).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyHot(){

  var ch = "0-6";
  if(document.getElementById('rhv0').checked) ch="0";
  else if(document.getElementById('rhv1').checked) ch="1";
  else if(document.getElementById('rhv2').checked) ch="2";
  else if(document.getElementById('rhv3').checked) ch="3";
  else if(document.getElementById('rhv4').checked) ch="4";
  else if(document.getElementById('rhv5').checked) ch="5";
  else if(document.getElementById('rhv6').checked) ch="6";

  var paths = ["/Equipment/HV/Settings/Current Hot Spot["+ch+"]"];

  var sets = [parseFloat(document.getElementById('hot').value)];

  mjsonrpc_db_paste(paths,sets).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyOffAll(){

  var paths = ["/Equipment/HV/Variables/ChState[0-6]",
               "/Equipment/CATHODE/Variables/ChState[0]"
              ];

  mjsonrpc_db_paste(paths,[0,0]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyOnAll(){

  var paths = ["/Equipment/HV/Variables/ChState[0-6]",
               "/Equipment/CATHODE/Variables/ChState[0]"
              ];

  mjsonrpc_db_paste(paths,[1,1]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyOnDrift(){

  var paths = ["/Equipment/HV/Variables/ChState[6]",
               "/Equipment/CATHODE/Variables/ChState[0]"
              ];

  mjsonrpc_db_paste(paths,[1,1]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyOffDrift(){

  var paths = ["/Equipment/HV/Variables/ChState[6]",
               "/Equipment/CATHODE/Variables/ChState[0]"
              ];

  mjsonrpc_db_paste(paths,[0,0]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyOnTr(){

  var paths = ["/Equipment/HV/Variables/ChState[0,2,4]"];
  mjsonrpc_db_paste(paths,[1]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyOffTr(){

  var paths = ["/Equipment/HV/Variables/ChState[0,2,4]"];

  mjsonrpc_db_paste(paths,[0]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyOnGain(){

  var paths = ["/Equipment/HV/Variables/ChState[1,3,5]"];
  mjsonrpc_db_paste(paths,[1]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

function applyOffGain(){

  var paths = ["/Equipment/HV/Variables/ChState[1,3,5]"];

  mjsonrpc_db_paste(paths,[0]).then(function(rpc) {
  }).catch(function(error) {
          mjsonrpc_error_alert(error);
  });

}

</script>

<title>HV</title>

<style>
.mtable td {
padding: 8px;
}
</style>

</head>

<body class="mcss">

<!-- header and side navigation will be filled in mhttpd_init -->
<div id="mheader"></div>
<div id="msidenav"></div>

<div id="mmain">
  <table class="mtable"style="font-size:18px">
    <tr>
      <th class="mtableheader" id="page_title" colspan="2">GEM High Voltage Control Page</th>
    </tr>
    <tr>
      <td style="vertical-align:center">
	<table class="mtable" style="float:left;width:6in">
	  <tr><th class="mtableheader" colspan=3>Electric Fields</tr>
	  <tr height="35"><th></th><th style="width:1.5in">Input</th><th style="width:1.5in">Set</th></tr>
	  <tr height="42">
	    <td>Drift field [kV/cm]</td>
	    <td align="center"><input id="txtRequestD" onclick="execCommand('selectAll',false,null)" style="width:1in" type="number" step="0.01"/></td>
	    <td align="right"><div id="txtSetD">0</div></td>
	  </tr>
	  <tr height="42">
	    <td>Transfer field 1 [kV/cm]</td>
	    <td align="center"><input id="txtRequestT1" onclick="execCommand('selectAll',false,null)" style="width:1in" type="number" step="0.01"/></td>
	    <td align="right"><div id="txtSetT1">0</div></td>
	  </tr>
	  <tr height="42">
	    <td>Transfer field 2 [kV/cm] <input type="checkbox" id="lockT" name="lockT" value="lock" onclick="getElementById('txtRequestT2').disabled = !(getElementById('lockT').checked);"></td>
	    <td align="center"><input id="txtRequestT2" onclick="execCommand('selectAll',false,null)" style="width:1in" type="number" step="0.01" disabled/></td>
	    <td align="right"><div id="txtSetT2">0</div></td>
	  </tr>
	  <tr height="42">
	    <td>VGEM 1 [V]</td>
	    <td align="center"><input id="txtRequestG1" onclick="execCommand('selectAll',false,null)" style="width:1in" type="number"/></td>
	    <td align="right"><div id="txtSetG1">0</div></td></tr>
	  <tr height="42">
	    <td>VGEM 2 [V] <input type="checkbox" id="lockG2" name="lockG2" value="lock" onclick="getElementById('txtRequestG2').disabled = !(getElementById('lockG2').checked);"> </td>
	    <td align="center"><input id="txtRequestG2" onclick="execCommand('selectAll',false,null)" style="width:1in" type="number" disabled/></td>
	    <td align="right"><div id="txtSetG2">0</div></td>
	  </tr>
	  <tr height="42">
	    <td>VGEM 3 [V] <input type="checkbox" id="lockG3" name="lockG3" value="lock" onclick="getElementById('txtRequestG3').disabled = !(getElementById('lockG3').checked);"> </td>
	    <td align="center"><input id="txtRequestG3" onclick="execCommand('selectAll',false,null)" style="width:1in" type="number" disabled/></td>
	    <td align="right"><div id="txtSetG3">0</div></td>
	  </tr>
	  <tr height="42">
	    <td>Offset [V] </td>
	    <td align="center"><input id="txtRequestOffset" onclick="execCommand('selectAll',false,null)" style="width:1in" type="number"/></td>
	    <td align="right"><div id="txtSetOffset">0</div></td>
	  </tr>
	  <tr height="55"><td colspan=3 align="center"><input class="mbutton" id="btnSet" type="button" value="SET ALL" onclick="applySetAll()" style="padding: 7px 20px;font-size:18px;margin:5px"/><input class="mbutton" id="btnSetZero" type="button" value="SET ZERO" onclick="applySetZero()" style="padding: 7px 20px;font-size:18px;margin:5px"/></td></tr>
	</table>
      </td>
      <td style="vertical-align:top">
	<table class="mtable" style="float:left;width:8in">
	  <tr><th colspan=6 class="mtableheader" >Readings</tr>
	  <tr><th style="width:1in"></th><th style="width:1in">Demand <br> [V]</th><th style="width:1in">Read <br> [V]</th><th style="width:1in">Current <br> [&mu;A]</th><th style="width:0.3in"><img style="width:0.2in" src="on-off.png" alt=""/></th><th style="width:0.3in"><img style="width:0.27in" src="trip3.png" alt=""/></th></tr>
	  <tr>
	    <td>HV0</td>
	    <td align="right"><div id="txtDemHV0" class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Demand[0]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Measured[0]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Current[0]"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChState[0]" data-color="#00FF00" data-background-color="red" style="width:20px;height:20px;border-radius:20px"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChStatus[0]" data-formula="x & 0x200" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div></td>
	  </tr>
	  <tr>
	    <td>HV1</td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Demand[1]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Measured[1]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Current[1]"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChState[1]" data-color="#00FF00" data-background-color="red" style="width:20px;height:20px;border-radius:20px"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChStatus[1]" data-formula="x & 0x200" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div></td>
	  </tr>
	  <tr>
	    <td>HV2</td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Demand[2]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Measured[2]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Current[2]"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChState[2]" data-color="#00FF00" data-background-color="red" style="width:20px;height:20px;border-radius:20px"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChStatus[2]" data-formula="x & 0x200" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div></td>
	  </tr>
	  <tr>
	    <td>HV3</td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Demand[3]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Measured[3]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Current[3]"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChState[3]" data-color="#00FF00" data-background-color="red" style="width:20px;height:20px;border-radius:20px"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChStatus[3]" data-formula="x & 0x200" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div></td>
	  </tr>
	  <tr>
	    <td>HV4</td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Demand[4]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Measured[4]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Current[4]"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChState[4]" data-color="#00FF00" data-background-color="red" style="width:20px;height:20px;border-radius:20px"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChStatus[4]" data-formula="x & 0x200" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div></td>
	  </tr>
	  <tr>
	    <td>HV5</td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Demand[5]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Measured[5]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Current[5]"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChState[5]" data-color="#00FF00" data-background-color="red" style="width:20px;height:20px;border-radius:20px"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChStatus[5]" data-formula="x & 0x200" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div></td>
	  </tr>
	  <tr>
	    <td>HV6</td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Demand[6]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Measured[6]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/HV/Variables/Current[6]"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChState[6]" data-color="#00FF00" data-background-color="red" style="width:20px;height:20px;border-radius:20px"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/ChStatus[6]" data-formula="x & 0x200" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div></td>
	  </tr>
	  <tr>
	    <td>HV7</td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/CATHODE/Variables/Demand[0]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/CATHODE/Variables/Measured[0]"></div></td>
	    <td align="right"><div class="modbvalue" data-format="f3" data-odb-path="/Equipment/CATHODE/Variables/Current[0]"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/CATHODE/Variables/ChState[0]" data-color="#00FF00" data-background-color="red" style="width:20px;height:20px;border-radius:20px"></div></td>
	    <td align="center"><div class="modbbox" data-odb-path="/Equipment/CATHODE/Variables/ChStatus[0]" data-formula="x & 0xFFFF" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div></td>
	  </tr>
	</table>
      </td>
    </tr>
    <tr>
      <td>
      <table class="mtable" style="width:6in;font-size:18px">
	<tr align="center">
	  <td colspan=2 style="width:2in"> <input class="mbutton" id="btnAllOff" type="button" value="ON ALL" onclick="applyOnAll()" style="padding: 7px 20px;font-size:18px;margin:5px"/> <input class="mbutton" id="btnAllOff" type="button" value="OFF ALL" onclick="applyOffAll()" style="padding: 7px 20px;font-size:18px;margin:5px"/></td>
	</tr>
	<tr align="center">
	  <td style="width:2in">DRIFT</td><td><input class="mbutton"id="btnDOn" type="button" value="ON" onclick="applyOnDrift()" style="padding: 7px 20px;font-size:18px;margin:5px"/><input class="mbutton" id="btnDOff" type="button" value="OFF" onclick="applyOffDrift()" style="padding: 7px 20px;font-size:18px;margin:5px"/></td>
	</tr>
	<tr align="center">
	  <td style="width:2in">TRANSFER</td><td><input class="mbutton" id="btnTOn" type="button" value="ON" onclick="applyOnTr()" style="padding: 7px 20px;font-size:18px;margin:5px"/><input class="mbutton" id="btnTOff" type="button" value="OFF" onclick="applyOffTr()" style="padding: 7px 20px;font-size:18px;margin:5px"/></td>
	</tr>
	<tr align="center">
	  <td style="width:2in">GAIN</td><td><input class="mbutton" id="btnGOn" type="button" value="ON" onclick="applyOnGain()" style="padding: 7px 20px;font-size:18px;margin:5px"/><input class="mbutton" id="btnGOff" type="button" value="OFF" onclick="applyOffGain()" style="padding: 7px 20px;font-size:18px;margin:5px"/></td>
	</tr>
      </table>
      </td>
      <td>
      <table class="mtable" style="width:5in;font-size:18px">
	<tr align="center">
	  <th class="mtableheader" colspan=2>Settings</th>
	</tr>
	<tr>
	<th colspan=2>
      <div align=center>
	<input type="radio" id="rhv0" name="channel" value="hv0" onclick="selectChannel(0)">
	<label for="hv0">HV0</label>&nbsp;&nbsp;
	<input type="radio" id="rhv1" name="channel" value="hv1" onclick="selectChannel(1)">
	<label for="hv1">HV1</label>&nbsp;&nbsp;
	<input type="radio" id="rhv2" name="channel" value="hv2" onclick="selectChannel(2)">
	<label for="hv2">HV2</label>&nbsp;&nbsp;
	<input type="radio" id="rhv3" name="channel" value="hv3" onclick="selectChannel(3)">
	<label for="hv3">HV3</label>&nbsp;&nbsp;
	<input type="radio" id="rhv4" name="channel" value="hv4" onclick="selectChannel(4)">
	<label for="hv4">HV4</label>&nbsp;&nbsp;<br>
	<input type="radio" id="rhv5" name="channel" value="hv5" onclick="selectChannel(5)">
	<label for="hv5">HV5</label>&nbsp;&nbsp;
	<input type="radio" id="rhv6" name="channel" value="hv6" onclick="selectChannel(6)">
	<label for="hv6">HV6</label>&nbsp;&nbsp;
	<input type="radio" id="rhvall" name="channel" value="hvall" onclick="selectChannel(-1)">
	<label for="hvall">ALL CAEN</label>&nbsp;&nbsp;<br>
	<input type="radio" id="rhv7" name="channel" value="hv7" onclick="selectChannel(7)">
	<label for="hv7">ISEG HV</label>
      </div></th></tr>
	<tr height="42" align="center">
	  <td style="width:2in" align="left">Ramp Up Speed [V/s]</td><td style="width:1in"><input id="rup" type="number" style="width:1in" onclick="execCommand('selectAll',false,null)" onchange="applyRUP()"></td>
	</tr>
	<tr height="42" align="center">
	  <td style="width:2in" align="left">Ramp Down Speed [V/s]</td><td><input id="rdw" type="number" style="width:1in" onclick="execCommand('selectAll',false,null)" onchange="applyRDW()"></td>
	</tr>
	<tr height="42" align="center">
	  <td style="width:2in" align="left">Trip Current [&mu;A]</td><td><input id="trip" type="number" style="width:1in" onclick="execCommand('selectAll',false,null)" onchange="applyTrip()"></td>
	</tr>
	<tr height="42" align="center">
	  <td style="width:2in" align="left">Trip Time [s]</td><td><input id="tript" type="number" style="width:1in" onclick="execCommand('selectAll',false,null)" onchange="applyTripT()"></td>
	</tr>
	<tr height="42" align="center">
	  <td style="width:2in" align="left">Hot Spot Current [&mu;A]</td><td><input id="hot" type="number" style="width:1in" onclick="execCommand('selectAll',false,null)" onchange="applyHot()"><div class="modbbox" data-odb-path="/Equipment/HV/Variables/Recovery" data-color="red" data-background-color="#00FF00" style="width:20px;height:20px;border-radius:20px"></div>
	  </td>
	</tr>
      </table>
      </td>
    </tr>
<!--
    <tr>
      <td colspan="3">
	<table class="mtable"">
	  <tr>
	    <td><div id="hIG" class="mjshistory" data-group="HV" data-panel="IGEM" style="width: 440px; height: 300px;" ></div></td>
	    <td><div id="hIT" class="mjshistory" data-group="HV" data-panel="ITRANSFER" style="width: 440px; height: 300px;" ></div></td>
	    <td><div id="hID" class="mjshistory" data-group="HV" data-panel="IDRIFT" style="width: 440px; height: 300px;" ></div></td>
	  </tr>
	  <tr>
	    <td><div id="hVG" class="mjshistory" data-group="HV" data-panel="VGEM" style="width: 440px; height: 300px;" ></div></td>
	    <td><div id="hVT" class="mjshistory" data-group="HV" data-panel="VTRANSFER" style="width: 440px; height: 300px;" ></div></td>
	    <td><div id="hVD" class="mjshistory" data-group="HV" data-panel="VDRIFT" style="width: 440px; height: 300px;" ></div></td>
	  </tr>
	</table>
      </td>
    </tr>
-->
  </table>
</div>

</body>
</html>
